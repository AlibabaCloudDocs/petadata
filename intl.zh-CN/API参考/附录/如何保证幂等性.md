# 如何保证幂等性 {#concept_znz_vbp_mfb .concept}

当通过调用创建实例接口CreateInstance创建HybridDB for MySQL实例时，如果遇到了请求超时或服务器内部错误时，客户端可能会尝试重发请求，这时客户端可以通过提供可选参数ClientToken避免服务器创建出比预期要多的实例，也就是通过提供ClientToken参数保证请求的幂等性。ClientToken是一个由客户端生成的唯一的、大小写敏感、不超过64个ASCII字符的字符串。

如果用户使用同一个ClientToken值调用创建实例接口，则服务端会返回相同的请求结果，包含相同的InstanceId。因此用户在遇到错误进行重试的时候，可以通过提供相同的ClientToken值，来确保HybridDB for MySQL只创建一个实例，并得到这个实例的InstanceId。

如果用户提供了一个已经使用过的ClientToken，但其他请求参数不同，则HybridDB for MySQL会返回IdempotentParameterMismatch的错误代码。但需要注意的是，SignatureNonce、Timestamp和Signature参数在重试时是需要变化的，因为HybridDB for MySQL使用SignatureNonce来防止重放攻击，使用Timestamp来标记每次请求时间，所以再次请求必须提供不同的SignatureNonce和Timestamp参数值，这同时也会导致Signature值的变化。

通常，客户端只需要在出现服务器端InternalError或ServiceUnavailable错误、或者无法得到响应结果的情况下进行重试操作。正常返回结果时，重试可以得到上次相同的结果，但不会对服务端带来任何影响。

